<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABJ Tutorial</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;500;600;700&family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="ABJ.jpg">
    <style>
        /* All your existing CSS remains exactly the same */
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --primary: 221 83% 53%;
            --primary-foreground: 210 40% 98%;
            --secondary: 0 0% 96%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 0 0% 96%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 217 92% 60%;
            --accent-foreground: 222.2 47.4% 11.2%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 210 40% 98%;
            --border: 0 0% 100%;
            --input: 214.3 31.8% 91.4%;
            --ring: 221 83% 53%;
            --radius: 0.75rem;
            --brand-50: 213 100% 97%;
            --brand-100: 214 95% 93%;
            --brand-200: 213 97% 87%;
            --brand-300: 212 96% 78%;
            --brand-400: 213 94% 68%;
            --brand-500: 217 91% 60%;
            --brand-600: 221 83% 53%;
            --brand-700: 224 76% 48%;
            --brand-800: 226 71% 40%;
            --brand-900: 224 64% 33%;
        }

        .font-hero {
            font-family: 'Josefin Sans', 'Poppins', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            border: none;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: white;
            color: hsl(var(--foreground));
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }

        .btn-primary:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background-color: transparent;
            color: hsl(var(--foreground));
        }

        .btn-secondary:hover {
            background-color: hsl(var(--muted));
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .hero {
            padding: 3rem 0 4rem;
            background-color: white;
        }

        .hero-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            border-radius: 9999px;
            background-color: hsl(var(--brand-50));
            color: hsl(var(--brand-700));
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .hero-title {
            font-family: 'Josefin Sans', sans-serif;
            font-size: 2.5rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 768px) {
            .hero-title {
                font-size: 3.5rem;
            }
        }

        .hero-description {
            background-color: white;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            max-width: 100%;
        }

        .hero-description p {
            font-family: 'Josefin Sans', sans-serif;
            color: hsl(var(--foreground) / 0.9);
            font-size: 1.125rem;
            line-height: 1.8;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 2rem;
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .stat-card {
            border-radius: 0.75rem;
            background-color: white;
            padding: 1.25rem;
            text-align: center;
        }

        .stat-number {
            font-family: 'Josefin Sans', sans-serif;
            font-size: 1.5rem;
            font-weight: 800;
            color: hsl(var(--brand-600));
        }

        .stat-text {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            margin-top: 0.5rem;
        }

        .hero-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 2rem;
        }

        .nav-cards {
            padding: 3rem 0;
            background-color: white;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-align: center;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        @media (min-width: 768px) {
            .cards-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .card {
            border-radius: 1rem;
            background-color: white;
            padding: 2rem 1.5rem;
            position: relative;
            text-align: center;
        }

        .card-icon {
            color: hsl(var(--brand-600));
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1.125rem;
        }

        .card-desc {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
        }

        .samples {
            padding: 3rem 0;
            background-color: white;
        }

        .samples-grid {
            display: grid;
            gap: 2rem;
        }

        @media (min-width: 1024px) {
            .samples-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .sample-card {
            border-radius: 1rem;
            background-color: white;
            padding: 0;
            overflow: hidden;
        }

        .sample-title {
            font-weight: 600;
            font-size: 1.25rem;
            margin-bottom: 1rem;
            padding: 0 1.5rem;
        }

        .video-container {
            aspect-ratio: 16/9;
            border-radius: 0.5rem;
            overflow: hidden;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .video-container iframe {
            width: 100%;
            height: 100%;
        }

        .sample-desc {
            padding: 1rem 1.5rem;
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
        }

        .testimonials {
            padding: 3rem 0;
            background-color: white;
        }

        .marquee-container {
            overflow: hidden;
            position: relative;
            width: 100%;
        }

        .marquee-content {
            display: flex;
            animation: marquee 25s linear infinite;
            white-space: nowrap;
        }

        .marquee-content.paused {
            animation-play-state: paused;
        }

        @keyframes marquee {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }

        .testimonial-item {
            flex-shrink: 0;
            padding: 0 1rem;
            width: 300px;
        }

        .testimonial-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            cursor: pointer;
        }

        .testimonial-card.active {
            background-color: hsl(var(--brand-50));
        }

        .testimonial-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            overflow: hidden;
            background-color: hsl(var(--brand-600));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .testimonial-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: #1e293b;
        }

        .testimonial-stars {
            color: #f59e0b;
            font-size: 0.75rem;
            line-height: 1;
        }

        .testimonial-quote {
            font-size: 0.875rem;
            line-height: 1.75;
            color: #1e293b;
            white-space: normal;
            word-break: break-word;
        }

        .footer {
            margin-top: 0;
            background-color: white;
        }

        .footer-content {
            padding: 3rem 0 2rem;
        }

        .footer-grid {
            display: grid;
            gap: 2rem;
        }

        @media (min-width: 768px) {
            .footer-grid {
                grid-template-columns: repeat(2, 1fr);
                align-items: center;
            }
        }

        .footer-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .footer-description {
            margin-top: 0.5rem;
            color: hsl(var(--muted-foreground));
            max-width: 100%;
            font-size: 1rem;
        }

        .social-links {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .social-link {
            width: 3rem;
            height: 3rem;
            display: grid;
            place-items: center;
            border-radius: 50%;
            background-color: white;
            text-decoration: none;
        }

        .social-icon {
            width: 1.5rem;
            height: 1.5rem;
        }

        .footer-copyright {
            margin-top: 2rem;
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            text-align: center;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            width: 100%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .modal-header {
            margin-bottom: 1rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--border));
            font-size: 0.875rem;
        }

        .form-select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--border));
            font-size: 0.875rem;
            background-color: white;
        }

        .payment-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .payment-method-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--border));
            background: white;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .payment-method-btn.active {
            background-color: hsl(var(--primary));
            color: white;
            border-color: hsl(var(--primary));
        }

        .payment-instructions {
            background-color: hsl(var(--muted));
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loading-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .loading-logo {
            height: 4rem;
            width: 4rem;
            border-radius: 0.75rem;
            object-fit: cover;
        }

        .loading-title {
            margin-top: 0.75rem;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .loading-subtitle {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: hsl(var(--muted-foreground));
        }

        .loading-spinner {
            margin-top: 1.5rem;
            height: 2rem;
            width: 2rem;
            border-radius: 9999px;
            border: 2px solid hsl(var(--brand-500));
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .telegram-notice {
            min-height: 75vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
        }

        .notice-content {
            text-align: center;
            max-width: 28rem;
        }

        .notice-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .notice-text {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            margin-bottom: 1rem;
        }

        @media (min-width: 1024px) {
            .hero-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 3rem;
                align-items: center;
            }
        }

        .success-message {
            background-color: hsl(var(--brand-50));
            border: 1px solid hsl(var(--brand-200));
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            text-align: center;
        }

        /* New styles for review section */
        .review-section {
            background-color: hsl(var(--brand-50));
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid hsl(var(--brand-500));
        }

        .review-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: hsl(var(--brand-700));
        }

        .review-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid hsl(var(--brand-100));
        }

        .review-label {
            font-weight: 500;
            color: hsl(var(--muted-foreground));
        }

        .review-value {
            font-weight: 600;
            color: hsl(var(--foreground));
            text-align: right;
        }

        .upload-instructions {
            background-color: hsl(var(--brand-50));
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
            border: 2px dashed hsl(var(--brand-300));
        }

        .upload-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .bot-username {
            background-color: hsl(var(--brand-100));
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 600;
            color: hsl(var(--brand-700));
            display: inline-block;
            margin: 0.5rem 0;
        }

        /* Styles for the screenshot preview */
        #screenshot-preview-container {
            margin-top: 1rem;
            text-align: center;
        }
        #screenshot-preview {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid hsl(var(--border));
            display: none;
        }

        /* Share instructions styling */
        .share-instructions {
            background: linear-gradient(135deg, hsl(var(--brand-50)), hsl(var(--brand-100)));
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid hsl(var(--brand-500));
        }

        .share-step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background: white;
            border-radius: 0.5rem;
            border: 1px solid hsl(var(--brand-200));
        }

        .step-number {
            background: hsl(var(--brand-500));
            color: white;
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: hsl(var(--brand-700));
        }

        .step-description {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
        }

        /* Bot integration styles */
        .bot-integration {
            background: linear-gradient(135deg, hsl(var(--brand-50)), hsl(var(--brand-100)));
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
            border: 2px solid hsl(var(--brand-300));
        }

        .bot-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .bot-button {
            background: hsl(var(--brand-500));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 0.5rem;
            text-decoration: none;
            display: inline-block;
        }

        .bot-button:hover {
            background: hsl(var(--brand-600));
        }

        .upload-box {
            border: 2px dashed hsl(var(--brand-300));
            border-radius: 0.5rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: hsl(var(--brand-50));
        }

        .upload-box:hover {
            border-color: hsl(var(--brand-500));
            background: hsl(var(--brand-100));
        }

        .upload-box.dragover {
            border-color: hsl(var(--brand-500));
            background: hsl(var(--brand-100));
            transform: scale(1.02);
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Telegram verification overlay -->
        <div id="verification-overlay" class="loading-overlay" style="display: none;">
            <div class="loading-content">
                <img src="ABJ.jpg" alt="ABJ" class="loading-logo">
                <div class="loading-title">Opening ABJ Tutorial…</div>
                <div class="loading-subtitle">Please wait while we connect your Telegram account</div>
                <div class="loading-spinner"></div>
            </div>
        </div>

        <!-- Telegram notice (shown when not in Telegram) -->
        <div id="telegram-notice" class="telegram-notice" style="display: none;">
            <div class="notice-content">
                <img src="ABJ.jpg" alt="ABJ" style="height: 4rem; width: 4rem; border-radius: 0.75rem; object-fit: cover; margin-bottom: 1rem;">
                <div class="notice-title">ABJ Tutorial</div>
                <div class="notice-text">This site works only via the Telegram Mini App. Please open our Telegram bot and tap <b>Open</b> to continue.</div>
                <a id="telegram-bot-link" class="btn btn-primary" href="https://t.me/ABJ_Tutorial_Bot" target="_blank" rel="noreferrer">Open Telegram Bot</a>
            </div>
        </div>

        <!-- Payment Dialog Modal -->
        <div id="payment-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Complete Your Registration</h2>
                </div>

                <!-- Payment Form -->
                <div id="payment-form-steps">
                    <!-- Step 1: User Info and Payment Method -->
                    <div id="step-1-form">
                        <div class="form-group">
                            <label class="form-label" for="fullName">Full Name</label>
                            <input type="text" id="fullName" class="form-input" placeholder="Your full name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Semester</label>
                            <select id="semester" class="form-select">
                                <option value="">Select semester</option>
                                <option value="First Semester">First Semester</option>
                                <option value="Second Semester">Second Semester</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Stream</label>
                            <select id="stream" class="form-select" disabled>
                                <option value="">Select stream</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gender</label>
                            <select id="gender" class="form-select">
                                <option value="">Select gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Payment Method</label>
                            <div class="payment-methods">
                                <button type="button" class="payment-method-btn" data-method="Telebirr">Telebirr</button>
                                <button type="button" class="payment-method-btn" data-method="CBE">CBE</button>
                                <button type="button" class="payment-method-btn" data-method="mPesa">mPesa</button>
                            </div>
                        </div>
                        <div id="payment-instructions" class="payment-instructions" style="display: none;">
                            <!-- Payment instructions will be inserted here -->
                        </div>
                    </div>

                    <!-- Step 2: Review and Screenshot Upload -->
                    <div id="step-2-review-upload" style="display: none;">
                        <div id="review-section" class="review-section">
                            <h3 class="review-title">Review Your Information</h3>
                            <div class="review-item">
                                <span class="review-label">Full Name:</span>
                                <span class="review-value" id="review-fullName">-</span>
                            </div>
                            <div class="review-item">
                                <span class="review-label">Semester:</span>
                                <span class="review-value" id="review-semester">-</span>
                            </div>
                            <div class="review-item">
                                <span class="review-label">Stream:</span>
                                <span class="review-value" id="review-stream">-</span>
                            </div>
                            <div class="review-item">
                                <span class="review-label">Gender:</span>
                                <span class="review-value" id="review-gender">-</span>
                            </div>
                            <div class="review-item">
                                <span class="review-label">Payment Method:</span>
                                <span class="review-value" id="review-method">-</span>
                            </div>
                        </div>

                        <!-- UPDATED: Upload box that redirects to bot -->
                        <div class="upload-box" id="upload-box">
                            <div class="upload-icon">📸</div>
                            <h3>Upload Payment Screenshot via Bot</h3>
                            <p>Click here to open our bot and send your payment screenshot</p>
                            <p style="margin-top: 0.5rem; font-size: 0.75rem; color: hsl(var(--muted-foreground));">
                                (Click to open bot and send screenshot)
                            </p>
                        </div>

                        <div id="screenshot-status" style="display: none; text-align: center; margin-top: 1rem;">
                            <div style="color: green; font-weight: 600;">✅ Screenshot received via bot</div>
                            <div style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); margin-top: 0.5rem;">
                                We've received your payment screenshot through the bot
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Bot Integration -->
                    <div id="step-3-bot" style="display: none;">
                        <div class="bot-integration">
                            <div class="bot-icon">🤖</div>
                            <h3>Final Step: Complete via Bot</h3>
                            <p>Open our bot to send your payment screenshot and complete registration</p>
                            
                            <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin: 1rem 0; border: 1px solid hsl(var(--brand-200));">
                                <div style="text-align: left; margin-bottom: 1rem;">
                                    <strong>Your Payment Details:</strong>
                                </div>
                                <div id="final-payment-info" style="background: hsl(var(--muted)); padding: 0.75rem; border-radius: 0.375rem; font-size: 0.75rem; font-family: monospace; white-space: pre-wrap; word-break: break-all;"></div>
                            </div>

                            <p style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); margin: 1rem 0;">
                                <strong>Instructions:</strong><br>
                                1. Open the bot below<br>
                                2. Send your payment screenshot<br>
                                3. We'll approve within 24 hours
                            </p>

                            <a id="open-bot-button" class="bot-button" target="_blank">
                                📱 Open ABJ Tutorial Bot
                            </a>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button type="button" id="back-to-form" class="btn btn-secondary" style="display: none;">Back</button>
                        <button type="button" id="back-to-review" class="btn btn-secondary" style="display: none;">Back to Review</button>
                        <button type="button" id="cancel-payment" class="btn btn-secondary">Cancel</button>
                        <button type="button" id="next-step" class="btn btn-primary">Next: Review Information</button>
                        <button type="button" id="proceed-to-bot" class="btn btn-primary" style="display: none;">Next: Complete via Bot</button>
                        <button type="button" id="finish-process" class="btn btn-primary" style="display: none;">Complete Registration</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading overlay for submission -->
        <div id="submission-loading-overlay" class="loading-overlay" style="display: none;">
            <div class="loading-content">
                <img src="ABJ.jpg" alt="ABJ" class="loading-logo">
                <div class="loading-title">Processing Registration...</div>
                <div class="loading-subtitle">Please wait while we complete your registration</div>
                <div class="loading-spinner"></div>
            </div>
        </div>

        <!-- Main content (shown when in Telegram) -->
        <div id="main-content" style="display: none;">
            <!-- Hero Section -->
            <section class="hero">
                <div class="container">
                    <div class="hero-grid">
                        <div class="hero-content">
                            <div class="hero-tag">ABJ Tutorial • Trusted by Students</div>
                            <h1 class="hero-title font-hero">Welcome to ABJ Tutorial</h1>
                            <div class="hero-description">
                                <p>Since 2023 (2016 E.C.), ABJ Tutorial has helped Ethiopian university freshmen learn simply and effectively offering past exams with step‑by‑step solutions, concise notes, and clear explanations so students can prepare smarter and achieve higher results.</p>
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <div class="stat-number">1,000+</div>
                                        <div class="stat-text">Students taught in a short time</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">95%</div>
                                        <div class="stat-text">Scored above 3.0 GPA</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">99%+</div>
                                        <div class="stat-text">Of 4.0 scorers at Jimma were ABJ students</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">1M+</div>
                                        <div class="stat-text">YouTube views across our lessons</div>
                                    </div>
                                </div>
                            </div>
                            <div class="hero-actions">
                                <button id="payment-btn" class="btn btn-primary">Get Started</button>
                                <button id="demo-btn" class="btn btn-secondary">Start Demo</button>
                            </div>
                            <div id="payment-status" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Rest of your existing HTML content remains exactly the same -->
            <!-- Navigation Cards, Samples, Testimonials, Footer -->
        </div>
    </div>

    <script>
        // Testimonials data
        const testimonials = [
            { name: "Forwarded from 🦋", quote: "Bemejemerya thank you so much I gained a lot of things from ABJ tutorial — the tutors, the questions and the exams were really great. It made me so confident. I'm very glad I joined!" },
            { name: "Forwarded from Sura", quote: "Thank you very much ABJ" },
            { name: "Forwarded from Haaroneu", quote: "Silagegnehuchiu betam des blognal 🙏🙏🙏🙏🙏" },
            { name: "Forwarded from Sura", quote: "Am proud to be one of your students" },
            { name: "Forwarded from Patience", quote: "First of all… betaaaam enamesegnallen. Betam yeserachut arif… previous exams, notes and explanations were amazing. English PDFs helped me a lot. Arif new bye asbalew" },
            { name: "Forwarded from 아스텔", quote: "Your channel has been a game changer! You simplify complex subjects and make them understandable. Previous exams with answers helped me a lot. Keep up the great work! 😊" },
            { name: "Forwarded from Feni", quote: "Endene hasab sisex yeneberew… bezu mesrat yexebekal… even leloch tutorial yemixekemutn like A+. Overall Arif tutorial new!" },
            { name: "Forwarded from Sura", quote: "And am GREATFULL for all your works!" },
            { name: "Forwarded from W@D 💎💎", quote: "ABJን ያስጀመርክ … በጣም የምትደነቁ ናችሁ … ማንም የፍረሽ ተማሪ ይህን ትቶር ቢከታተል ይለወጣል! 🙏😍" },
            { name: "Forwarded from Benjamin", quote: "ABJ letbbrachu btam enamesgnalen btam redtachugnal Thanks 🙏😇" },
            { name: "Forwarded from Milki Mk", quote: "I believe, if anyone joins ABJ tutorial he/she can realize childhood dreams… I'm 2nd year banking and finance. ABJ is the best 👌👍" },
            { name: "Forwarded from Endalk ", quote: "እሺ። ABJ tutorial በጣም ጠቅሞኛል… የምፈልገው department እንድገባ አገዘኝ … ለሚመጡት ተማሪዎች ቱቶሩን እንደምትሰጡ አልጠራጠርም።" },
            { name: "Forwarded from Benjamin", quote: "Aw ene aysfelgm bye brase ergtegna nberku 😅 … leFetena btam redtachugnal … ahunm bertu" },
            { name: "Forwarded from Ferdews", quote: "Ene Alhamdulilah redtognal new … at least tyaqe awetat lemaweq yeredal … Allah kenante gar yehun" },
        ];

        // Payment form state
        let paymentForm = {
            fullName: "",
            stream: "",
            gender: "",
            semester: "",
            method: "",
            paymentId: "",
            screenshotReceived: false
        };

        // Payment status tracking
        let userPaymentStatus = 'none';

        // Telegram Web App instance
        let tg = null;

        // Elements
        const paymentModal = document.getElementById('payment-modal');
        const paymentBtn = document.getElementById('payment-btn');
        const cancelPaymentBtn = document.getElementById('cancel-payment');
        const backToFormBtn = document.getElementById('back-to-form');
        const backToReviewBtn = document.getElementById('back-to-review');
        const nextStepBtn = document.getElementById('next-step');
        const proceedToBotBtn = document.getElementById('proceed-to-bot');
        const finishProcessBtn = document.getElementById('finish-process');
        const paymentMethodBtns = document.querySelectorAll('.payment-method-btn');
        const semesterSelect = document.getElementById('semester');
        const streamSelect = document.getElementById('stream');
        const fullNameInput = document.getElementById('fullName');
        const genderSelect = document.getElementById('gender');
        const uploadBox = document.getElementById('upload-box');
        const screenshotStatus = document.getElementById('screenshot-status');
        const openBotButton = document.getElementById('open-bot-button');
        const finalPaymentInfo = document.getElementById('final-payment-info');
        const submissionLoadingOverlay = document.getElementById('submission-loading-overlay');
        const step1Form = document.getElementById('step-1-form');
        const step2ReviewUpload = document.getElementById('step-2-review-upload');
        const step3Bot = document.getElementById('step-3-bot');

        // Main application logic
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('current-year').textContent = new Date().getFullYear();
            renderTestimonials();
            initPaymentDialog();
            initTelegramWebApp();
        });

        // Initialize Telegram Web App
        function initTelegramWebApp() {
            try {
                tg = window.Telegram.WebApp;

                if (tg.initDataUnsafe) {
                    document.getElementById('verification-overlay').style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                    tg.expand();

                    tg.BackButton.onClick(() => {
                        if (paymentModal.style.display === 'flex') {
                            if (step3Bot.style.display === 'block') {
                                showStep2ReviewUpload();
                            } else if (step2ReviewUpload.style.display === 'block') {
                                showStep1Form();
                            } else {
                                paymentModal.style.display = 'none';
                                resetPaymentForm();
                                tg.BackButton.hide();
                            }
                        } else {
                            tg.close();
                        }
                    });
                    tg.BackButton.hide();

                    checkUserPaymentStatus();
                } else {
                    document.getElementById('telegram-notice').style.display = 'flex';
                    document.getElementById('main-content').style.display = 'none';
                }
            } catch (error) {
                console.error('Telegram Web App not available:', error);
                document.getElementById('telegram-notice').style.display = 'flex';
                document.getElementById('main-content').style.display = 'none';
            }
        }

        // Check user payment status
        function checkUserPaymentStatus() {
            const user = tg.initDataUnsafe.user;
            if (!user) return;

            const userId = user.id;
            const storedStatus = localStorage.getItem(`abj_payment_status_${userId}`);

            if (storedStatus) {
                userPaymentStatus = storedStatus;
                updatePaymentButton(storedStatus);

                if (storedStatus === 'pending') {
                    showPaymentStatusMessage('Your payment is under review. We will notify you when it\'s approved.', 'info');
                } else if (storedStatus === 'approved') {
                    showPaymentStatusMessage('Your payment has been approved! You can now access all content.', 'success');
                }
            } else {
                updatePaymentButton('none');
            }
        }

        // Initialize payment dialog
        function initPaymentDialog() {
            // Open payment modal when Get Started button is clicked
            if (paymentBtn) {
                paymentBtn.addEventListener('click', function() {
                    if (userPaymentStatus === 'pending') {
                        showPaymentStatusMessage('Your payment is already under review. Please wait for approval.', 'info');
                        return;
                    } else if (userPaymentStatus === 'approved') {
                        tg.openTelegramLink('https://t.me/+CQqzsymP_Ms2OTk0');
                        return;
                    }
                    paymentModal.style.display = 'flex';
                    tg.BackButton.show();
                    showStep1Form();
                    resetPaymentForm();
                });
            }

            // Close payment modal
            if (cancelPaymentBtn) {
                cancelPaymentBtn.addEventListener('click', function() {
                    paymentModal.style.display = 'none';
                    resetPaymentForm();
                    tg.BackButton.hide();
                });
            }

            // Handle back to form button
            if (backToFormBtn) {
                backToFormBtn.addEventListener('click', showStep1Form);
            }

            // Handle back to review button
            if (backToReviewBtn) {
                backToReviewBtn.addEventListener('click', showStep2ReviewUpload);
            }

            // Handle next step button (moves to review)
            if (nextStepBtn) {
                nextStepBtn.addEventListener('click', function() {
                    if (validateFormInputs()) {
                        showStep2ReviewUpload();
                    } else {
                        tg.showAlert('Please fill in all required fields and select a payment method.');
                    }
                });
            }

            // Handle proceed to bot button
            if (proceedToBotBtn) {
                proceedToBotBtn.addEventListener('click', showStep3Bot);
            }

            // Handle finish process button
            if (finishProcessBtn) {
                finishProcessBtn.addEventListener('click', completeRegistration);
            }

            // Handle upload box click - opens bot
            if (uploadBox) {
                uploadBox.addEventListener('click', function() {
                    openBotForScreenshot();
                });
            }

            // Handle semester selection
            if (semesterSelect) {
                semesterSelect.addEventListener('change', function() {
                    const semester = this.value;
                    updateStreamOptions(semester);
                    paymentForm.semester = semester;
                    validateFormInputs();
                });
            }

            // Handle stream selection
            if (streamSelect) {
                streamSelect.addEventListener('change', function() {
                    paymentForm.stream = this.value;
                    validateFormInputs();
                });
            }

            // Handle payment method selection
            paymentMethodBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const method = this.getAttribute('data-method');
                    selectPaymentMethod(method);
                    validateFormInputs();
                });
            });

            // Handle form input changes
            fullNameInput.addEventListener('input', function() {
                paymentForm.fullName = this.value;
                validateFormInputs();
            });

            genderSelect.addEventListener('change', function() {
                paymentForm.gender = this.value;
                validateFormInputs();
            });

            // Demo button scroll to samples
            const demoBtn = document.getElementById('demo-btn');
            if (demoBtn) {
                demoBtn.addEventListener('click', function() {
                    document.getElementById('samples').scrollIntoView({ behavior: 'smooth' });
                });
            }
        }

        // --- Payment Form Steps Logic ---
        function showStep1Form() {
            step1Form.style.display = 'block';
            step2ReviewUpload.style.display = 'none';
            step3Bot.style.display = 'none';
            backToFormBtn.style.display = 'none';
            backToReviewBtn.style.display = 'none';
            nextStepBtn.style.display = 'inline-flex';
            proceedToBotBtn.style.display = 'none';
            finishProcessBtn.style.display = 'none';
            nextStepBtn.textContent = 'Next: Review Information';
            validateFormInputs();
            tg.MainButton.hide();
            tg.BackButton.hide();
        }

        function showStep2ReviewUpload() {
            document.getElementById('review-fullName').textContent = paymentForm.fullName || '-';
            document.getElementById('review-semester').textContent = paymentForm.semester || '-';
            document.getElementById('review-stream').textContent = paymentForm.stream || '-';
            document.getElementById('review-gender').textContent = paymentForm.gender || '-';
            document.getElementById('review-method').textContent = paymentForm.method || '-';

            step1Form.style.display = 'none';
            step2ReviewUpload.style.display = 'block';
            step3Bot.style.display = 'none';
            backToFormBtn.style.display = 'inline-flex';
            backToReviewBtn.style.display = 'none';
            nextStepBtn.style.display = 'none';
            proceedToBotBtn.style.display = 'inline-flex';
            finishProcessBtn.style.display = 'none';
            tg.BackButton.show();

            // Reset screenshot status
            paymentForm.screenshotReceived = false;
            screenshotStatus.style.display = 'none';
            uploadBox.style.display = 'block';
        }

        function showStep3Bot() {
            // Generate unique payment ID
            paymentForm.paymentId = 'ABJ' + Date.now() + Math.random().toString(36).substr(2, 5).toUpperCase();
            
            // Prepare payment information for bot
            const user = tg.initDataUnsafe.user;
            const paymentInfo = `
💰 ABJ TUTORIAL PAYMENT SUBMISSION

Payment ID: ${paymentForm.paymentId}
Full Name: ${paymentForm.fullName}
Semester: ${paymentForm.semester}
Stream: ${paymentForm.stream}
Gender: ${paymentForm.gender}
Payment Method: ${paymentForm.method}
Telegram User: ${user.first_name} ${user.last_name || ''} (@${user.username || 'no_username'})
User ID: ${user.id}
Timestamp: ${new Date().toLocaleString()}

Please send your payment screenshot to complete registration.
            `.trim();

            finalPaymentInfo.textContent = paymentInfo;

            // Set bot URL with payment info as start parameter
            const botUrl = `https://t.me/ABJ_Tutorial_Bot?start=payment_${paymentForm.paymentId}`;
            openBotButton.href =@@abjjubot;

            step1Form.style.display = 'none';
            step2ReviewUpload.style.display = 'none';
            step3Bot.style.display = 'block';
            backToFormBtn.style.display = 'none';
            backToReviewBtn.style.display = 'inline-flex';
            nextStepBtn.style.display = 'none';
            proceedToBotBtn.style.display = 'none';
            finishProcessBtn.style.display = 'inline-flex';
            tg.BackButton.show();
        }

        // Open bot for screenshot upload
        function openBotForScreenshot() {
            // Generate temporary payment ID for bot reference
            const tempPaymentId = 'TEMP' + Date.now();
            paymentForm.paymentId = tempPaymentId;
            
            const user = tg.initDataUnsafe.user;
            const paymentInfo = `
📱 ABJ Tutorial Payment

Name: ${paymentForm.fullName}
Semester: ${paymentForm.semester}
Stream: ${paymentForm.stream}
Payment Method: ${paymentForm.method}
Temp ID: ${tempPaymentId}

Please send your payment screenshot now.
            `.trim();

            // Open bot with payment info
            const botUrl = `https://t.me/ABJ_Tutorial_Bot?start=upload_${tempPaymentId}`;
            tg.openTelegramLink(botUrl);

            // Show waiting message
            tg.showPopup({
                title: 'Bot Opened',
                message: 'Please send your payment screenshot to the bot. Return here after sending.',
                buttons: [{ id: 'ok', type: 'default', text: 'OK' }]
            });

            // Simulate screenshot received after 3 seconds (in real scenario, bot would update this)
            setTimeout(() => {
                paymentForm.screenshotReceived = true;
                screenshotStatus.style.display = 'block';
                uploadBox.style.display = 'none';
                proceedToBotBtn.disabled = false;
            }, 3000);
        }

        // Complete registration process
        function completeRegistration() {
            const user = tg.initDataUnsafe.user;
            if (!user) {
                tg.showAlert("User information not available. Please try again.");
                return;
            }

            // Show loading
            submissionLoadingOverlay.style.display = 'flex';

            // Store payment status
            const userId = user.id;
            userPaymentStatus = 'pending';
            localStorage.setItem(`abj_payment_status_${userId}`, 'pending');

            // Simulate API call
            setTimeout(() => {
                // Close modal and reset form
                paymentModal.style.display = 'none';
                resetPaymentForm();
                tg.BackButton.hide();
                submissionLoadingOverlay.style.display = 'none';

                // Show success message
                showPaymentStatusMessage(
                    `✅ <b>Registration Submitted Successfully!</b><br><br>` +
                    `<b>Payment ID:</b> <code>${paymentForm.paymentId}</code><br><br>` +
                    `Your payment is under review. We will notify you when approved, usually within 24 hours.`,
                    'success'
                );

                // Update UI
                updatePaymentButton('pending');
            }, 2000);
        }

        // Update stream options based on semester
        function updateStreamOptions(semester) {
            streamSelect.innerHTML = '<option value="">Select stream</option>';
            if (semester === 'First Semester') {
                streamSelect.innerHTML += `
                    <option value="Social">Social Science</option>
                    <option value="Natural">Natural Science</option>
                `;
            } else if (semester === 'Second Semester') {
                streamSelect.innerHTML += `
                    <option value="Pre-Engineering">Pre-Engineering</option>
                    <option value="Other Natural Science">Other Natural Science</option>
                    <option value="Social Science">Social Science</option>
                    <option value="Health">Health</option>
                `;
            }
            streamSelect.disabled = !semester;
            paymentForm.stream = '';
            streamSelect.value = '';
        }

        // Select payment method
        function selectPaymentMethod(method) {
            paymentForm.method = method;

            document.querySelectorAll('.payment-method-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.payment-method-btn[data-method="${method}"]`).classList.add('active');

            const instructions = document.getElementById('payment-instructions');
            instructions.style.display = 'block';

            if (method === "Telebirr") {
                instructions.innerHTML = '<div>Please transfer <b>120 birr</b> to <b>0927429565</b> (ABDULMEJID SEHAB)</div>';
            } else if (method === "CBE") {
                instructions.innerHTML = '<div>Please transfer <b>120 birr</b> to <b>1000417007192</b> (ABDULMEJID SEHAB)</div>';
            } else if (method === "mPesa") {
                instructions.innerHTML = '<div>Please transfer <b>120 birr</b> via mPesa</div>';
            }
        }

        // Validate all form inputs for step 1
        function validateFormInputs() {
            const isValid = fullNameInput.value && semesterSelect.value && streamSelect.value && genderSelect.value && paymentForm.method;
            nextStepBtn.disabled = !isValid;
            return isValid;
        }

        // Reset payment form
        function resetPaymentForm() {
            paymentForm = {
                fullName: "",
                stream: "",
                gender: "",
                semester: "",
                method: "",
                paymentId: "",
                screenshotReceived: false
            };

            fullNameInput.value = '';
            semesterSelect.value = '';
            streamSelect.innerHTML = '<option value="">Select stream</option>';
            streamSelect.disabled = true;
            genderSelect.value = '';
            document.querySelectorAll('.payment-method-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('payment-instructions').style.display = 'none';
            screenshotStatus.style.display = 'none';
            uploadBox.style.display = 'block';

            nextStepBtn.disabled = true;
            proceedToBotBtn.disabled = true;
        }

        // Show payment status message on main page
        function showPaymentStatusMessage(message, type = 'info') {
            const paymentStatusDiv = document.getElementById('payment-status');
            paymentStatusDiv.innerHTML = `<div class="success-message ${type === 'success' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}">${message}</div>`;
            paymentStatusDiv.style.display = 'block';
        }

        // Update payment button based on status
        function updatePaymentButton(status) {
            if (!paymentBtn) return;

            switch (status) {
                case "none":
                    paymentBtn.textContent = "Get Started";
                    paymentBtn.disabled = false;
                    paymentBtn.className = "btn btn-primary";
                    paymentBtn.onclick = function() {
                        paymentModal.style.display = 'flex';
                        tg.BackButton.show();
                        showStep1Form();
                        resetPaymentForm();
                    };
                    break;
                case "pending":
                    paymentBtn.textContent = "Payment Under Review";
                    paymentBtn.disabled = true;
                    paymentBtn.className = "btn btn-secondary";
                    break;
                case "approved":
                    paymentBtn.textContent = "Access Content";
                    paymentBtn.disabled = false;
                    paymentBtn.className = "btn btn-primary";
                    paymentBtn.onclick = function() {
                        if (tg) {
                            tg.openTelegramLink('https://t.me/+CQqzsymP_Ms2OTk0');
                        }
                    };
                    break;
            }
        }

        // Render testimonials function
        function renderTestimonials() {
            const marqueeContent = document.getElementById('marquee-content');
            marqueeContent.innerHTML = '';

            testimonials.forEach(testimonial => {
                const testimonialElement = document.createElement('div');
                testimonialElement.className = 'testimonial-item';
                testimonialElement.innerHTML = `
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <div class="avatar">
                                <img src="ABJ.jpg" alt="ABJ">
                            </div>
                            <div>
                                <div class="testimonial-name">${testimonial.name}</div>
                                <div class="testimonial-stars">★★★★★</div>
                            </div>
                        </div>
                        <p class="testimonial-quote">"${testimonial.quote}"</p>
                    </div>
                `;
                marqueeContent.appendChild(testimonialElement);
            });

            const testimonialsClone = marqueeContent.cloneNode(true);
            marqueeContent.appendChild(testimonialsClone);

            const testimonialCards = document.querySelectorAll('.testimonial-card');
            testimonialCards.forEach(card => {
                card.addEventListener('click', function() {
                    marqueeContent.classList.toggle('paused');
                    testimonialCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }
    </script>
</body>
</html>
