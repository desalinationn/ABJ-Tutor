<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABJ Tutorial</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;500;600;700&family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="ABJ.jpg">
    <style>
        /* All your existing CSS remains exactly the same */
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --primary: 221 83% 53%;
            --primary-foreground: 210 40% 98%;
            --secondary: 0 0% 96%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 0 0% 96%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 217 92% 60%;
            --accent-foreground: 222.2 47.4% 11.2%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 210 40% 98%;
            --border: 0 0% 100%;
            --input: 214.3 31.8% 91.4%;
            --ring: 221 83% 53%;
            --radius: 0.75rem;
            --brand-50: 213 100% 97%;
            --brand-100: 214 95% 93%;
            --brand-200: 213 97% 87%;
            --brand-300: 212 96% 78%;
            --brand-400: 213 94% 68%;
            --brand-500: 217 91% 60%;
            --brand-600: 221 83% 53%;
            --brand-700: 224 76% 48%;
            --brand-800: 226 71% 40%;
            --brand-900: 224 64% 33%;
        }

        .font-hero {
            font-family: 'Josefin Sans', 'Poppins', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            border: none;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: white;
            color: hsl(var(--foreground));
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }

        .btn-primary:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background-color: transparent;
            color: hsl(var(--foreground));
        }

        .btn-secondary:hover {
            background-color: hsl(var(--muted));
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .hero {
            padding: 3rem 0 4rem;
            background-color: white;
        }

        .hero-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            border-radius: 9999px;
            background-color: hsl(var(--brand-50));
            color: hsl(var(--brand-700));
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .hero-title {
            font-family: 'Josefin Sans', sans-serif;
            font-size: 2.5rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 768px) {
            .hero-title {
                font-size: 3.5rem;
            }
        }

        .hero-description {
            background-color: white;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            max-width: 100%;
        }

        .hero-description p {
            font-family: 'Josefin Sans', sans-serif;
            color: hsl(var(--foreground) / 0.9);
            font-size: 1.125rem;
            line-height: 1.8;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 2rem;
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .stat-card {
            border-radius: 0.75rem;
            background-color: white;
            padding: 1.25rem;
            text-align: center;
        }

        .stat-number {
            font-family: 'Josefin Sans', sans-serif;
            font-size: 1.5rem;
            font-weight: 800;
            color: hsl(var(--brand-600));
        }

        .stat-text {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            margin-top: 0.5rem;
        }

        .hero-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 2rem;
        }

        .nav-cards {
            padding: 3rem 0;
            background-color: white;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-align: center;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        @media (min-width: 768px) {
            .cards-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .card {
            border-radius: 1rem;
            background-color: white;
            padding: 2rem 1.5rem;
            position: relative;
            text-align: center;
        }

        .card-icon {
            color: hsl(var(--brand-600));
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1.125rem;
        }

        .card-desc {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
        }

        .samples {
            padding: 3rem 0;
            background-color: white;
        }

        .samples-grid {
            display: grid;
            gap: 2rem;
        }

        @media (min-width: 1024px) {
            .samples-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .sample-card {
            border-radius: 1rem;
            background-color: white;
            padding: 0;
            overflow: hidden;
        }

        .sample-title {
            font-weight: 600;
            font-size: 1.25rem;
            margin-bottom: 1rem;
            padding: 0 1.5rem;
        }

        .video-container {
            aspect-ratio: 16/9;
            border-radius: 0.5rem;
            overflow: hidden;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .video-container iframe {
            width: 100%;
            height: 100%;
        }

        .sample-desc {
            padding: 1rem 1.5rem;
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
        }

        .testimonials {
            padding: 3rem 0;
            background-color: white;
        }

        .marquee-container {
            overflow: hidden;
            position: relative;
            width: 100%;
        }

        .marquee-content {
            display: flex;
            animation: marquee 25s linear infinite;
            white-space: nowrap;
        }

        .marquee-content.paused {
            animation-play-state: paused;
        }

        @keyframes marquee {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }

        .testimonial-item {
            flex-shrink: 0;
            padding: 0 1rem;
            width: 300px;
        }

        .testimonial-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            cursor: pointer;
        }

        .testimonial-card.active {
            background-color: hsl(var(--brand-50));
        }

        .testimonial-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            overflow: hidden;
            background-color: hsl(var(--brand-600));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .testimonial-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: #1e293b;
        }

        .testimonial-stars {
            color: #f59e0b;
            font-size: 0.75rem;
            line-height: 1;
        }

        .testimonial-quote {
            font-size: 0.875rem;
            line-height: 1.75;
            color: #1e293b;
            white-space: normal;
            word-break: break-word;
        }

        .footer {
            margin-top: 0;
            background-color: white;
        }

        .footer-content {
            padding: 3rem 0 2rem;
        }

        .footer-grid {
            display: grid;
            gap: 2rem;
        }

        @media (min-width: 768px) {
            .footer-grid {
                grid-template-columns: repeat(2, 1fr);
                align-items: center;
            }
        }

        .footer-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .footer-description {
            margin-top: 0.5rem;
            color: hsl(var(--muted-foreground));
            max-width: 100%;
            font-size: 1rem;
        }

        .social-links {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .social-link {
            width: 3rem;
            height: 3rem;
            display: grid;
            place-items: center;
            border-radius: 50%;
            background-color: white;
            text-decoration: none;
        }

        .social-icon {
            width: 1.5rem;
            height: 1.5rem;
        }

        .footer-copyright {
            margin-top: 2rem;
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            text-align: center;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            width: 100%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .modal-header {
            margin-bottom: 1rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--border));
            font-size: 0.875rem;
        }

        .form-select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--border));
            font-size: 0.875rem;
            background-color: white;
        }

        .payment-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .payment-method-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--border));
            background: white;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .payment-method-btn.active {
            background-color: hsl(var(--primary));
            color: white;
            border-color: hsl(var(--primary));
        }

        .payment-instructions {
            background-color: hsl(var(--muted));
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loading-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .loading-logo {
            height: 4rem;
            width: 4rem;
            border-radius: 0.75rem;
            object-fit: cover;
        }

        .loading-title {
            margin-top: 0.75rem;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .loading-subtitle {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: hsl(var(--muted-foreground));
        }

        .loading-spinner {
            margin-top: 1.5rem;
            height: 2rem;
            width: 2rem;
            border-radius: 9999px;
            border: 2px solid hsl(var(--brand-500));
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .telegram-notice {
            min-height: 75vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
        }

        .notice-content {
            text-align: center;
            max-width: 28rem;
        }

        .notice-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .notice-text {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            margin-bottom: 1rem;
        }

        @media (min-width: 1024px) {
            .hero-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 3rem;
                align-items: center;
            }
        }

        .success-message {
            background-color: hsl(var(--brand-50));
            border: 1px solid hsl(var(--brand-200));
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            text-align: center;
        }

        /* New styles for review section */
        .review-section {
            background-color: hsl(var(--brand-50));
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid hsl(var(--brand-500));
        }

        .review-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: hsl(var(--brand-700));
        }

        .review-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid hsl(var(--brand-100));
        }

        .review-label {
            font-weight: 500;
            color: hsl(var(--muted-foreground));
        }

        .review-value {
            font-weight: 600;
            color: hsl(var(--foreground));
            text-align: right;
        }

        .upload-instructions {
            background-color: hsl(var(--brand-50));
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
            border: 2px dashed hsl(var(--brand-300));
        }

        .upload-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .bot-username {
            background-color: hsl(var(--brand-100));
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 600;
            color: hsl(var(--brand-700));
            display: inline-block;
            margin: 0.5rem 0;
        }

        /* Styles for the screenshot preview */
        #screenshot-preview-container {
            margin-top: 1rem;
            text-align: center;
        }
        #screenshot-preview {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid hsl(var(--border));
            display: none;
        }

        /* Share instructions styling */
        .share-instructions {
            background: linear-gradient(135deg, hsl(var(--brand-50)), hsl(var(--brand-100)));
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid hsl(var(--brand-500));
        }

        .share-step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background: white;
            border-radius: 0.5rem;
            border: 1px solid hsl(var(--brand-200));
        }

        .step-number {
            background: hsl(var(--brand-500));
            color: white;
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: hsl(var(--brand-700));
        }

        .step-description {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
        }

        /* Bot integration styles */
        .bot-integration {
            background: linear-gradient(135deg, hsl(var(--brand-50)), hsl(var(--brand-100)));
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
            border: 2px solid hsl(var(--brand-300));
        }

        .bot-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .bot-button {
            background: hsl(var(--brand-500));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 0.5rem;
            text-decoration: none;
            display: inline-block;
        }

        .bot-button:hover {
            background: hsl(var(--brand-600));
        }

        .upload-box {
            border: 2px dashed hsl(var(--brand-300));
            border-radius: 0.5rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: hsl(var(--brand-50));
        }

        .upload-box:hover {
            border-color: hsl(var(--brand-500));
            background: hsl(var(--brand-100));
        }

        .upload-box.dragover {
            border-color: hsl(var(--brand-500));
            background: hsl(var(--brand-100));
            transform: scale(1.02);
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Telegram verification overlay -->
        <div id="verification-overlay" class="loading-overlay" style="display: none;">
            <div class="loading-content">
                <img src="ABJ.jpg" alt="ABJ" class="loading-logo">
                <div class="loading-title">Opening ABJ Tutorial…</div>
                <div class="loading-subtitle">Please wait while we connect your Telegram account</div>
                <div class="loading-spinner"></div>
            </div>
        </div>

        <!-- Telegram notice (shown when not in Telegram) -->
        <div id="telegram-notice" class="telegram-notice" style="display: none;">
            <div class="notice-content">
                <img src="ABJ.jpg" alt="ABJ" style="height: 4rem; width: 4rem; border-radius: 0.75rem; object-fit: cover; margin-bottom: 1rem;">
                <div class="notice-title">ABJ Tutorial</div>
                <div class="notice-text">This site works only via the Telegram Mini App. Please open our Telegram bot and tap <b>Open</b> to continue.</div>
                <a id="telegram-bot-link" class="btn btn-primary" href="https://t.me/abjjubot" target="_blank" rel="noreferrer">Open Telegram Bot</a>
            </div>
        </div>
        
        <!-- Main content (shown when in Telegram) -->
        <div id="main-content" style="display: none;">
            <!-- Hero Section -->
            <section class="hero">
                <div class="container">
                    <div class="hero-grid">
                        <div class="hero-content">
                            <div class="hero-tag">ABJ Tutorial • Trusted by Students</div>
                            <h1 class="hero-title font-hero">Welcome to ABJ Tutorial</h1>
                            <div class="hero-description">
                                <p>Since 2023 (2016 E.C.), ABJ Tutorial has helped Ethiopian university freshmen learn simply and effectively offering past exams with step‑by‑step solutions, concise notes, and clear explanations so students can prepare smarter and achieve higher results.</p>
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <div class="stat-number">1,000+</div>
                                        <div class="stat-text">Students taught in a short time</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">95%</div>
                                        <div class="stat-text">Scored above 3.0 GPA</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">99%+</div>
                                        <div class="stat-text">Of 4.0 scorers at Jimma were ABJ students</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-number">1M+</div>
                                        <div class="stat-text">YouTube views across our lessons</div>
                                    </div>
                                </div>
                            </div>
                            <div class="hero-actions">
                                <button id="get-started-btn" class="btn btn-primary">Get Started</button>
                                <button id="demo-btn" class="btn btn-secondary">Start Demo</button>
                            </div>
                            <div id="payment-status" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Navigation Cards Section -->
            <section class="nav-cards">
                <div class="container">
                    <h2 class="section-title">What We Offer</h2>
                    <div class="cards-grid">
                        <div class="card">
                            <div class="card-icon">📚</div>
                            <h3 class="card-title">Detailed Notes</h3>
                            <p class="card-desc">Comprehensive and easy-to-understand notes for all subjects.</p>
                        </div>
                        <div class="card">
                            <div class="card-icon">📝</div>
                            <h3 class="card-title">Past Exams</h3>
                            <p class="card-desc">Access to previous university exams with solutions.</p>
                        </div>
                        <div class="card">
                            <div class="card-icon">💡</div>
                            <h3 class="card-title">Step-by-Step Solutions</h3>
                            <p class="card-desc">Clear and detailed explanations for every problem.</p>
                        </div>
                        <div class="card">
                            <div class="card-icon">🗣️</div>
                            <h3 class="card-title">Live Q&A Sessions</h3>
                            <p class="card-desc">Interactive sessions to clarify doubts and enhance understanding.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Samples Section -->
            <section id="samples" class="samples">
                <div class="container">
                    <h2 class="section-title">Our Learning Samples</h2>
                    <div class="samples-grid">
                        <div class="sample-card">
                            <h3 class="sample-title">Physics Tutorial</h3>
                            <div class="video-container">
                                <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ?si=i_h-iK61gE5l1wR7" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                            </div>
                            <p class="sample-desc">A sample physics lesson explaining fundamental concepts with real-world examples.</p>
                        </div>
                        <div class="sample-card">
                            <h3 class="sample-title">Mathematics Problem Solving</h3>
                            <div class="video-container">
                                <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ?si=i_h-iK61gE5l1wR7" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                            </div>
                            <p class="sample-desc">Walkthrough of a challenging math problem, breaking it down into simple steps.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Testimonials Section -->
            <section class="testimonials">
                <div class="container">
                    <h2 class="section-title">What Our Students Say</h2>
                    <div class="marquee-container">
                        <div id="marquee-content" class="marquee-content">
                            <!-- Testimonial items will be rendered here by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Footer Section -->
            <footer class="footer">
                <div class="container footer-content">
                    <div class="footer-grid">
                        <div>
                            <h3 class="footer-title">ABJ Tutorial</h3>
                            <p class="footer-description">Your partner in academic excellence for Ethiopian university freshmen.</p>
                        </div>
                        <div class="social-links">
                            <a href="https://t.me/abjjubot" target="_blank" class="social-link" aria-label="Telegram">
                                <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm4.276 7.425a.75.75 0 01.077.712l-1.353 4.276a.75.75 0 01-1.094.464l-2.709-1.921-.715.715.938 2.536a.75.75 0 01-.264.846L8 16.208V9.176l5.776-3.85a.75.75 0 01.996.111l2.091 2.923z" clip-rule="evenodd"></path></svg>
                            </a>
                            <a href="#" target="_blank" class="social-link" aria-label="YouTube">
                                <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M19.613 2.133a2.536 2.536 0 00-1.785-1.785C16.34 0 12 0 12 0S7.66 0 6.172.348a2.536 2.536 0 00-1.785 1.785C4 3.66 4 8 4 8v8c0 4.34 0 7.66.387 7.867a2.536 2.536 0 001.785 1.785c1.488.348 5.828.348 5.828.348S16.34 24 17.828 23.652a2.536 2.536 0 001.785-1.785C20 20.34 20 16 20 16V8c0-4.34 0-7.66-.387-7.867zM9 16.5v-9l6 4.5-6 4.5z"></path></svg>
                            </a>
                            <a href="#" target="_blank" class="social-link" aria-label="Instagram">
                                <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm3.336 2.502a1.5 1.5 0 00-1.5-1.5h-5.672a1.5 1.5 0 00-1.5 1.5v5.672a1.5 1.5 0 001.5 1.5h5.672a1.5 1.5 0 001.5-1.5V4.502zM12 15a3 3 0 100-6 3 3 0 000 6zM18.887 5.922a.5.5 0 100-1 .5.5 0 000 1z" clip-rule="evenodd"></path></svg>
                            </a>
                        </div>
                    </div>
                    <div class="footer-copyright">
                        &copy; <span id="current-year"></span> ABJ Tutorial. All rights reserved.
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <script>
        // Testimonials data
        const testimonials = [
            { name: "Forwarded from 🦋", quote: "Bemejemerya thank you so much I gained a lot of things from ABJ tutorial — the tutors, the questions and the exams were really great. It made me so confident. I'm very glad I joined!" },
            { name: "Forwarded from Sura", quote: "Thank you very much ABJ" },
            { name: "Forwarded from Haaroneu", quote: "Silagegnehuchiu betam des blognal 🙏🙏🙏🙏🙏" },
            { name: "Forwarded from Sura", quote: "Am proud to be one of your students" },
            { name: "Forwarded from Patience", quote: "First of all… betaaaam enamesegnallen. Betam yeserachut arif… previous exams, notes and explanations were amazing. English PDFs helped me a lot. Arif new bye asbalew" },
            { name: "Forwarded from 아스텔", quote: "Your channel has been a game changer! You simplify complex subjects and make them understandable. Previous exams with answers helped me a lot. Keep up the great work! 😊" },
            { name: "Forwarded from Feni", quote: "Endene hasab sisex yeneberew… bezu mesrat yexebekal… even leloch tutorial yemixekemutn like A+. Overall Arif tutorial new!" },
            { name: "Forwarded from Sura", quote: "And am GREATFULL for all your works!" },
            { name: "Forwarded from W@D 💎💎", quote: "ABJን ያስጀመርክ … በጣም የምትደነቁ ናችሁ … ማንም የፍረሽ ተማሪ ይህን ትቶር ቢከታተል ይለወጣል! 🙏😍" },
            { name: "Forwarded from Benjamin", quote: "ABJ letbbrachu btam enamesgnalen btam redtachugnal Thanks 🙏😇" },
            { name: "Forwarded from Milki Mk", quote: "I believe, if anyone joins ABJ tutorial he/she can realize childhood dreams… I'm 2nd year banking and finance. ABJ is the best 👌👍" },
            { name: "Forwarded from Endalk ", quote: "እሺ። ABJ tutorial በጣም ጠቅሞኛል… የምፈልገው department እንድገባ አገዘኝ … ለሚመጡት ተማሪዎች ቱቶሩን እንደምትሰጡ አልጠራጠርም።" },
            { name: "Forwarded from Benjamin", quote: "Aw ene aysfelgm bye brase ergtegna nberku 😅 … leFetena btam redtachugnal … ahunm bertu" },
            { name: "Forwarded from Ferdews", quote: "Ene Alhamdulilah redtognal new … at least tyaqe awetat lemaweq yeredal … Allah kenante gar yehun" },
        ];

        // Payment status tracking
        let userPaymentStatus = 'none'; // 'none', 'pending', 'approved', 'rejected'

        // Telegram Web App instance
        let tg = null;

        // Elements
        const getStartedBtn = document.getElementById('get-started-btn');
        const demoBtn = document.getElementById('demo-btn');
        const paymentStatusDiv = document.getElementById('payment-status'); // New element to show message

        // Constants
        const BOT_USERNAME = "abjjubot"; // Ensure this matches your bot's username
        const ACCESS_CHANNEL_LINK = "https://t.me/+CQqzsymP_Ms2OTk0"; // Your main channel link

        // Main application logic
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('current-year').textContent = new Date().getFullYear();
            renderTestimonials();
            initTelegramWebApp();
        });

        // Initialize Telegram Web App
        function initTelegramWebApp() {
            try {
                tg = window.Telegram.WebApp;

                if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                    document.getElementById('verification-overlay').style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                    tg.expand();

                    tg.BackButton.onClick(() => {
                        tg.close();
                    });
                    tg.BackButton.hide(); // Hide Back button by default

                    // Request user status from bot
                    tg.sendData(JSON.stringify({ command: 'get_user_status' }));
                    
                    // Listen for data from the bot
                    tg.onEvent('invoiceClosed', function(status){
                        if (status === 'paid') {
                            showPaymentStatusMessage('Payment successful! Your access will be approved shortly.', 'success');
                            // Optionally, refresh status
                            tg.sendData(JSON.stringify({ command: 'get_user_status' }));
                        } else if (status === 'cancelled') {
                            showPaymentStatusMessage('Payment cancelled.', 'info');
                        }
                    });

                    tg.onEvent('themeChanged', function() {
                        // Handle theme changes if needed
                        document.body.style.backgroundColor = tg.themeParams.bg_color;
                        document.body.style.color = tg.themeParams.text_color;
                    });
                    
                    // Listen for messages coming from the bot
                    window.addEventListener('message', function(event) {
                        if (event.origin === window.location.origin && event.data && event.data.type === 'bot_user_status') {
                            updateGetStartedButton(event.data.status);
                        }
                    });

                } else {
                    document.getElementById('telegram-notice').style.display = 'flex';
                    document.getElementById('main-content').style.display = 'none';
                }
            } catch (error) {
                console.error('Telegram Web App not available:', error);
                document.getElementById('telegram-notice').style.display = 'flex';
                document.getElementById('main-content').style.display = 'none';
            }
        }

        // Show payment status message on main page
        function showPaymentStatusMessage(message, type = 'info') {
            paymentStatusDiv.innerHTML = `<div class="success-message ${type === 'success' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}">${message}</div>`;
            paymentStatusDiv.style.display = 'block';
        }

        // Update Get Started button based on status
        function updateGetStartedButton(status) {
            userPaymentStatus = status; // Update the global status variable
            if (!getStartedBtn) return;

            switch (status) {
                case "none":
                case "rejected": // If rejected, allow them to register again
                    getStartedBtn.textContent = "Get Started";
                    getStartedBtn.disabled = false;
                    getStartedBtn.className = "btn btn-primary";
                    getStartedBtn.onclick = function() {
                        if (tg) {
                            tg.openTelegramLink(`https://t.me/${BOT_USERNAME}?start=register`);
                        }
                    };
                    if (status === "rejected") {
                        showPaymentStatusMessage('Your previous payment was rejected. Please re-register or contact support.', 'info');
                    } else {
                        paymentStatusDiv.style.display = 'none'; // Hide if no message needed
                    }
                    break;
                case "pending":
                    getStartedBtn.textContent = "Payment Under Review";
                    getStartedBtn.disabled = true;
                    getStartedBtn.className = "btn btn-secondary";
                    showPaymentStatusMessage('Your payment is under review. We will notify you when it\'s approved.', 'info');
                    break;
                case "approved":
                    getStartedBtn.textContent = "Access Content";
                    getStartedBtn.disabled = false;
                    getStartedBtn.className = "btn btn-primary";
                    getStartedBtn.onclick = function() {
                        if (tg) {
                            tg.openTelegramLink(ACCESS_CHANNEL_LINK);
                        }
                    };
                    showPaymentStatusMessage('Your payment has been approved! You can now access all content.', 'success');
                    break;
                default:
                    // Fallback for unknown status
                    getStartedBtn.textContent = "Get Started";
                    getStartedBtn.disabled = false;
                    getStartedBtn.className = "btn btn-primary";
                    getStartedBtn.onclick = function() {
                        if (tg) {
                            tg.openTelegramLink(`https://t.me/${BOT_USERNAME}?start=register`);
                        }
                    };
                    paymentStatusDiv.style.display = 'none';
                    break;
            }
        }

        // Demo button scroll to samples
        if (demoBtn) {
            demoBtn.addEventListener('click', function() {
                document.getElementById('samples').scrollIntoView({ behavior: 'smooth' });
            });
        }

        // Render testimonials function
        function renderTestimonials() {
            const marqueeContent = document.getElementById('marquee-content');
            marqueeContent.innerHTML = '';

            testimonials.forEach(testimonial => {
                const testimonialElement = document.createElement('div');
                testimonialElement.className = 'testimonial-item';
                testimonialElement.innerHTML = `
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <div class="avatar">
                                <img src="ABJ.jpg" alt="ABJ">
                            </div>
                            <div>
                                <div class="testimonial-name">${testimonial.name}</div>
                                <div class="testimonial-stars">★★★★★</div>
                            </div>
                        </div>
                        <p class="testimonial-quote">"${testimonial.quote}"</p>
                    </div>
                `;
                marqueeContent.appendChild(testimonialElement);
            });

            // Clone for continuous marquee effect
            const testimonialsClone = marqueeContent.cloneNode(true);
            marqueeContent.appendChild(testimonialsClone);

            const testimonialCards = document.querySelectorAll('.testimonial-card');
            testimonialCards.forEach(card => {
                card.addEventListener('click', function() {
                    marqueeContent.classList.toggle('paused');
                    testimonialCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }
    </script>
</body>
</html>
